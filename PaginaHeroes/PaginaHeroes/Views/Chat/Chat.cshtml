@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}


<main class="contenedor">

</main>

    <script text="text/javascript" src="~/js/Chat.js"></script>
    <script src="~/lib/microsoft/signalr/dist/browser/signalr.min.js"></script>


<script>

    var connection = new signalR.HubConnectionBuilder().withUrl("/Chat").build();

    connection.start().then(() => {
        connection.invoke("AddToGroups", chatID)
    }).catch((e) => console.error(e));


    document.getElementById("boton").addEventListener("click", (event) => {

        let usuario = document.getElementById("usuario").value;
        let mensaje  = document.getElementById("mensaje").value;

        connection.invoke("SendMessage", "1","2", usuario, mensaje).catch((err) => console.error(err.toString()));

        document.getElementById("mensaje").value = "";
        document.getElementById("mensaje").focus();

        event.preventDefault();
    })

    connection.on("ReceiveMessage", (usuario, mensaje) => {
        var mensaje = "<div><b>" + usuario + " dijo:</b>" + mensaje + "</div>";
        document.getElementById("mensajes").innerHTML = mensaje + document.getElementById("mensajes").innerHTML;
    })


</script>
